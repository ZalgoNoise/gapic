FROM zalgonoise/docker-baseimage-alpine:latest

LABEL maintainer="Zalgo Noise <zalgo.noise@gmail.com>"
LABEL version="0.6-beta"
LABEL git_repo="https://github.com/zalgonoise/gapic"

# Get source files

COPY ./src/bin /src/bin
COPY ./src/schema /src/schema

# Add needed dependencies
# jq to parse JSON
# fzf (fuzzy finder) is the program of choice for menus

RUN apk add \
    --no-cache \
    --update \
    jq \
    fzf \
    && mkdir -p /src/data/.creds /src/log \
    && echo "[]" > /src/log/requests.json

# Prepare gapic to execute on container runtime

RUN chown -R app:app /src

CMD ["/src/bin/gapic_exec.sh", "/init"]